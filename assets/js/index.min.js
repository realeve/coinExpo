!function(){function e(e,t){r.score=e,r.times=1,r.num=t,c.save(),100==e&&60>=t&&u()}function t(){100==r.score&&r.num<60?($('[name="sucessInfo"] .weui_msg_desc').html('本次活动您一共得了<span name="totalScore" style="font-weight:bold;color:#445"> 100 </span>分'),$(".weui_icon_msg").last().addClass("weui_icon_success").removeClass("weui_icon_warn"),$(".weui_msg_title").text("请凭二维码联系工作人员领取礼品").show(),u()):($(".weui_msg_desc").html("您的答题机会已经用完"),$(".weui_msg_title").text("每人仅允许答题一次").show(),$(".weui_msg").css("margin-top","120px").removeClass("hidden").parent().css("background-color","#fff")),$(".weui_msg").removeClass("hidden"),$("#fullpage").fullpage({easingcss3:"cubic-bezier(0.25, 0.5, 0.35, 1.15)",afterLoad:function(e,t){2==t?$(".iSlider-arrow").hide():$(".iSlider-arrow").show()}}),setTimeout(function(){$.fn.fullpage.moveTo(2)},300)}function i(e,t){function i(){if(!c)return o[e.answer-1]+1;var t=e.answer.map(function(e){return o[e-1]+1});return t.join(",")}var n=[],a=[];a=s(e.question.length);var o=[];a.map(function(e,t){o[e]=t});var r='<div class="section main-bg"',c="object"==typeof e.answer,u=c?"checkbox":"radio";r+='<h1 class="title"></h1>',r+='<div class="weui_cells_title answer-num">'+t+"."+e.title+"</div>",r+='<div class="weui_cells weui_cells_checkbox weui_cells_dark" data-id='+(t-1)+" data-answer="+i()+">",e.question.map(function(e,i){n[i]="",n[i]+='    <label class="weui_cell weui_check_label">',n[i]+='<div class="weui_cell_hd">',n[i]+='    <input type="'+u+'" class="weui_check" name="radio'+(t-1)+'">',n[i]+='    <i class="weui_icon_checked"></i>',n[i]+="</div>",n[i]+='<div class="weui_cell_bd weui_cell_primary" data-value='+o[i]+">",n[i]+="    <p>"+e+"</p>",n[i]+="</div></label>"});for(var l="",m=0;m<e.question.length;m++)l+=n[a[m]];return r+=l+"</div></div>"}function n(e,t){return Math.random()>.5?-1:1}function s(e){for(var t=[],i=0;e>i;i++)t.push(i);return t.sort(n)}function a(e,t){return e.substring(e.length-t,e.length)}function o(e){var t=new Date,i=t.getFullYear(),n=a("0"+(t.getMonth()+1),2),s=a("0"+t.getDate(),2),o=t.getHours(),r=t.getMinutes(),c=t.getSeconds();return i+"-"+n+"-"+s+" "+o+":"+r+":"+c}var r,c=function(){function e(){r=localStorage.getItem("coinexpo"),r=null!=r?$.parseJSON(r):{score:0,times:0}}function t(){localStorage.setItem("coinexpo",JSON.stringify(r))}return{load:e,save:t}}();c.load();var u=function(){$(".qrcode").removeClass("hidden");var e="http://cbpm.applinzi.com/topic/coinExpo/prize.html?timestamp="+r.timestamp+"&rectime="+o();$(".qrcode").qrcode({width:200,height:200,text:e})};if(r.times)return void t();var l,m=10,d={loadComplete:!1,total:0,error:[],answerList:[],isAnswered:[],timeReleased:!1,isStarted:!1,timeLength:0,sourceList:[],scoresPerAnswer:0,isSubmit:!1,isLogin:!1,loginData:{},maxAnswerNum:5,answerTimes:1,examPaper:"coin",endDate:"2016年11月4日至6日",examEnd:1,sportid:10,multiCheckAnswer:[]},f=[];$('[name="sucessInfo"] .weui_msg_title').hide(),$.getJSON("data/"+d.examPaper+".min.json",function(e){var t=e.length;d.sourceList=s(t),t=t<=d.maxAnswerNum?t:d.maxAnswerNum,d.maxAnswerNum=t,$('[name="nums"]').text(t),d.scoresPerAnswer=100/t,$('[name="scores"]').text(d.scoresPerAnswer.toFixed(0));for(var n=0;t>n;n++)$('[name="sucessInfo"]').before(i(e[d.sourceList[n]],n+1)),d.isAnswered[n]=0,d.multiCheckAnswer[n]=[];var a='<div class="weui_opr_area"><p class="weui_btn_area"><a href="javascript:;" class="weui_btn weui_btn_primary_yellow" id="submit">提交</a></p></div>';for($(".answer-num").last().parent().append(a),l=t+2,n=0;l>n;n++)f[n]=n%2?"#fff":"#445"}).done(function(){document.getElementById("autoplay").play(),p()});var w=o(1),p=function(){function t(e,t){var i=e.length;if(i!=t.length)return 0;e.sort(),t.sort();for(var n=0;i>n;n++)if(e[n]!=t[n])return 0;return 1}function i(e,t,i){var n=e-1;"down"==i&&n>0&&l-1>n&&!d.isAnswered[n-1]&&$.alert("第"+n+"题您还没有作答！","警告！",function(){$.fn.fullpage.moveTo(e)}),e>l&&"down"==i&&$(".iSlider-arrow").hide()}function n(t,i){var n="";e(t,i),n=100==t&&60>i?"请凭二维码联系工作人员领取礼品":"感谢您的参与！",$('[name="sucessInfo"] .weui_msg_desc').html('提交成功，您一共得了<span name="totalScore" style="font-weight:bold;color:#445"> '+t+" </span>分"),$(".weui_icon_msg").last().addClass("weui_icon_success").removeClass("weui_icon_warn"),$('[name="sucessInfo"] .weui_msg_title').text(n).show()}function s(){var e=!0;d.isAnswered.map(function(t,i){if(!t){var n=i+1;$.toast("第"+n+"题尚未作答，请先填写完所有题目再交卷"),e=!1}})}function a(e){$.ajax({url:"http://cbpc540.applinzi.com/index.php?s=/addon/GoodVoice/GoodVoice/setSafeExamData",data:e,dataType:"jsonp",callback:"JsonCallback",success:function(t){0==t.status?$('[name="sucessInfo"] .weui_msg_title').text("提交失败，请稍后重试"):n(e.score,t.uid),$.fn.fullpage.moveSectionDown()},error:function(e){var t="提交失败，请退出页面重新进入";$('[name="sucessInfo"] .weui_msg_title').text(t).show()}}).always(function(){d.isSubmit=!0,$("#submit").hide()})}$(".weui_check_label").on("click",function(e){var i=$(this).parents(".weui_cells"),n=$(this).find(".weui_cell_primary"),s=i.data("id"),a=n.data("value")+1,o=""+i.data("answer"),r=-1!=o.indexOf(",");if(d.isAnswered[s]=1,!r)return void(d.answerList[s]=a==o?1:0);o=o.split(",");var c=d.multiCheckAnswer[s].indexOf(a);-1==c?d.multiCheckAnswer[s].push(a):d.multiCheckAnswer[s].splice(a,1),d.answerList[s]=t(d.multiCheckAnswer[s],o)}),$("#fullpage").fullpage({easingcss3:"cubic-bezier(0.25, 0.5, 0.35, 1.15)",onLeave:function(e,t,n){i(e,t,n)},navigation:!0,afterLoad:function(e,t){t==l-1?$(".iSlider-arrow").hide():t==l?($(".iSlider-arrow").hide(),d.isSubmit||setTimeout(function(){$.fn.fullpage.moveSectionUp()},500)):$(".iSlider-arrow").show()}}),$(".weui_msg").removeClass("hidden"),$("#submit").on("click",function(e){if(d.error=[],d.total=0,d.answerList.map(function(e,t){d.total+=e,e||d.error.push(d.sourceList[t])}),s){var t="";d.error.map(function(e){t+=e+","}),t=t.length?t.substring(0,t.length-1):"-1",r.timestamp=(new Date).getTime()+"t"+(1e3*Math.random()).toFixed(0)+(1e3*Math.random()).toFixed(0);var i={score:(d.total*d.scoresPerAnswer).toFixed(0),rec_time:o(0),start_time:w,uid:0,iTimes:1,oldScore:0,sportid:m,errors:r.timestamp};$.confirm("您确定要交卷吗?","交卷",function(){a(i)},function(){$.fn.fullpage.moveTo(1)}),$.modal({title:"提示",text:"您确定要交卷吗?",buttons:[{text:"交卷",onClick:function(){a(i)}},{text:"检查一遍",onClick:function(){$.fn.fullpage.moveTo(2)}}]})}})}}();
//# sourceMappingURL=index.min.js.map